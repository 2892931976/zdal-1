<?xml version="1.0" encoding="gbk"?>
<App name="allavailable" dbmode="dev" idcName="gzone" zoneError="EXCEPTOIN">
  <AppDataSource name="test" dataBaseType="MYSQL" version="1" zoneDs="" document="false" hotspot="">
    <datasource name="test" dataSourceType="SHARD">
      <shard>
        <tableName>card_no_month</tableName>
        <dbRules>
          <dbRule>Integer.valueOf(#card_no#.substring(9,10),10) % 4;</dbRule>
        </dbRules>
        <tableRules>
          <tableRule>Integer.valueOf(#card_no#.substring(9,10),10) % 2 * 12 + #gmtTime,1_month,12#.getAt(Calendar.MONTH)</tableRule>
        </tableRules>
        <tableSuffix>twoColumnForEachDB:[_00-_01],[_00-_11]</tableSuffix>
        <dbIndex>SETBYPOOL:master_0,master_1,master_2,master_3</dbIndex>
      </shard>
      <datasource name="master" dataSourceType="FAILOVER" failoverRule="master">
        <datasource name="physics0" dataSourceType="PHYSICS">
          <jdbcUrl>jdbc:mysql://mysql-1-2.bjl.alipay.net:3306/tddl_sample_0</jdbcUrl>
          <userName>mysql</userName>
          <password>-76079f94c1e11c89</password>
          <driverClass>com.mysql.jdbc.Driver</driverClass>
          <maxConn>10</maxConn>
          <minConn>1</minConn>
          <blockingTimeoutMillis>180</blockingTimeoutMillis>
          <idleTimeoutMinutes>180</idleTimeoutMinutes>
          <preparedStatementCacheSize>100</preparedStatementCacheSize>
          <queryTimeout>180</queryTimeout>
          <sqlValve>-1,1</sqlValve>
          <tableValve />
          <transactionValve>-1,1</transactionValve>
          <datasource name="master_0" dataSourceType="LOGIC" />
        </datasource>
        <datasource name="physics1" dataSourceType="PHYSICS">
          <jdbcUrl>jdbc:mysql://mysql-1-2.bjl.alipay.net:3306/tddl_sample_1</jdbcUrl>
          <userName>mysql</userName>
          <password>-76079f94c1e11c89</password>
          <driverClass>com.mysql.jdbc.Driver</driverClass>
          <maxConn>10</maxConn>
          <minConn>1</minConn>
          <blockingTimeoutMillis>180</blockingTimeoutMillis>
          <idleTimeoutMinutes>180</idleTimeoutMinutes>
          <preparedStatementCacheSize>100</preparedStatementCacheSize>
          <queryTimeout>180</queryTimeout>
          <sqlValve>-1,1</sqlValve>
          <tableValve />
          <transactionValve>-1,1</transactionValve>
          <datasource name="master_1" dataSourceType="LOGIC" />
        </datasource>
        <datasource name="physics2" dataSourceType="PHYSICS">
          <jdbcUrl>jdbc:mysql://mysql-2-2.bjl.alipay.net:3306/tddl_sample_2</jdbcUrl>
          <userName>mysql</userName>
          <password>4476b9e0bb1cb2cbdf8592078de921bc</password>
          <driverClass>com.mysql.jdbc.Driver</driverClass>
          <maxConn>10</maxConn>
          <minConn>1</minConn>
          <blockingTimeoutMillis>180</blockingTimeoutMillis>
          <idleTimeoutMinutes>180</idleTimeoutMinutes>
          <preparedStatementCacheSize>100</preparedStatementCacheSize>
          <queryTimeout>180</queryTimeout>
          <sqlValve>-1,1</sqlValve>
          <tableValve />
          <transactionValve>-1,1</transactionValve>
          <datasource name="master_2" dataSourceType="LOGIC" />
        </datasource>
        <datasource name="physics3" dataSourceType="PHYSICS">
          <jdbcUrl>jdbc:mysql://mysql-2-2.bjl.alipay.net:3306/tddl_sample_3</jdbcUrl>
          <userName>mysql</userName>
          <password>4476b9e0bb1cb2cbdf8592078de921bc</password>
          <driverClass>com.mysql.jdbc.Driver</driverClass>
          <maxConn>10</maxConn>
          <minConn>1</minConn>
          <blockingTimeoutMillis>180</blockingTimeoutMillis>
          <idleTimeoutMinutes>180</idleTimeoutMinutes>
          <preparedStatementCacheSize>100</preparedStatementCacheSize>
          <queryTimeout>180</queryTimeout>
          <sqlValve>-1,1</sqlValve>
          <tableValve />
          <transactionValve>-1,1</transactionValve>
          <datasource name="master_3" dataSourceType="LOGIC" />
        </datasource>
      </datasource>
    </datasource>
  </AppDataSource>
</App>

